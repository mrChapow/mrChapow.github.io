<!DOCTYPE html>
<html lang="en" style="background:#000!important;background-color:#000!important">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helm - 3D Interactive Product</title>
    <meta name="theme-color" content="#000000" />
    <meta name="msapplication-navbutton-color" content="#000000" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <style>
      html{background:#000!important;background-color:#000!important;color-scheme:dark}
      body{background:#000!important;background-color:#000!important;margin:0;padding:0;min-height:100vh}
      *{box-sizing:border-box}
      html::before{content:'';position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000!important;z-index:-1}
    </style>
    <style>
        /* Custom CSS Variables for Easy Spacing Adjustments */
        :root {
          --desktop-price-top: 25vh;
          --desktop-desc-top: 45vh;
          --desktop-panels-right: 25vw;
          --desktop-panel-width: 350px;
          --mobile-price-bottom: 22vh;
          --mobile-desc-bottom: 6vh;
          --mobile-panel-width: 90vw;
          --mobile-panel-max-width: 400px;
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
          background: #000000;
          min-height: 100vh;
          overflow: hidden;
        }

        #root {
          width: 100vw;
          height: 100vh;
          position: relative;
        }

        .canvas-container {
          width: 100%;
          height: 100%;
          position: relative;
          background: #000000;
        }

        .glass-panel {
          background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.18) 0%,
            rgba(255, 255, 255, 0.12) 50%,
            rgba(255, 255, 255, 0.15) 100%);
          backdrop-filter: blur(40px) saturate(180%);
          border: 1px solid rgba(255, 255, 255, 0.35);
          border-top: 2px solid rgba(255, 255, 255, 0.5);
          border-radius: 24px;
          padding: 20px;
          box-shadow: 
            0 20px 40px rgba(0, 0, 0, 0.3),
            0 8px 16px rgba(0, 0, 0, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.4);
          position: fixed;
          z-index: 10;
          width: var(--desktop-panel-width);
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Only apply hover effects on devices that support hover (not touch) */
        @media (hover: hover) {
          .glass-panel:hover {
            transform: translateY(-2px);
            box-shadow: 
              0 25px 50px rgba(0, 0, 0, 0.4),
              0 12px 20px rgba(0, 0, 0, 0.25),
              inset 0 1px 0 rgba(255, 255, 255, 0.5);
          }
        }

        .price-panel {
          top: var(--desktop-price-top);
          right: var(--desktop-panels-right);
        }

        .description-panel {
          top: var(--desktop-desc-top);
          right: var(--desktop-panels-right);
        }

        .glass-panel h1 {
          font-size: 2.5rem;
          font-weight: 700;
          color: #ffffff;
          margin: 0 0 8px 0;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .glass-panel h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: #ffffff;
          margin: 0 0 12px 0;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .glass-panel p {
          color: rgba(255, 255, 255, 0.9);
          font-size: 1rem;
          line-height: 1.5;
          margin: 0 0 20px 0;
        }

        .glass-panel .text-sm {
          font-size: 0.9rem;
          line-height: 1.4;
        }

        .buy-button {
          background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
          color: white;
          border: none;
          border-radius: 16px;
          padding: 14px 28px;
          font-size: 1.1rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 
            0 8px 16px rgba(34, 197, 94, 0.3),
            0 4px 8px rgba(34, 197, 94, 0.2);
          width: 100%;
        }

        /* Only apply button hover effects on devices that support hover */
        @media (hover: hover) {
          .buy-button:hover {
            transform: translateY(-2px);
            box-shadow: 
              0 12px 24px rgba(34, 197, 94, 0.4),
              0 6px 12px rgba(34, 197, 94, 0.3);
            background: linear-gradient(135deg, #16A34A 0%, #15803D 100%);
          }
        }

        .buy-button:active {
          transform: translateY(0);
          box-shadow: 
            0 4px 8px rgba(34, 197, 94, 0.3),
            0 2px 4px rgba(34, 197, 94, 0.2);
        }

        /* Modal Styles */
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          background: rgba(0, 0, 0, 0.8);
          backdrop-filter: blur(8px);
          z-index: 100;
          display: none;
          align-items: center;
          justify-content: center;
        }

        .modal-overlay.show {
          display: flex;
        }

        .modal-content {
          background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.18) 0%,
            rgba(255, 255, 255, 0.12) 50%,
            rgba(255, 255, 255, 0.15) 100%);
          backdrop-filter: blur(40px) saturate(180%);
          border: 1px solid rgba(34, 197, 94, 0.3);
          border-radius: 24px;
          padding: 32px;
          max-width: 500px;
          width: 90vw;
          color: white;
          position: relative;
        }

        .modal-title {
          font-size: 1.5rem;
          font-weight: 700;
          text-align: center;
          margin-bottom: 24px;
        }

        .modal-text {
          color: rgba(255, 255, 255, 0.9);
          margin-bottom: 24px;
          text-align: center;
        }

        .form-group {
          margin-bottom: 16px;
        }

        .form-label {
          display: block;
          margin-bottom: 8px;
          font-weight: 500;
        }

        .form-input {
          width: 100%;
          padding: 12px 16px;
          background: rgba(255, 255, 255, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 12px;
          color: white;
          font-size: 1rem;
        }

        .form-input:focus {
          outline: none;
          border-color: #22C55E;
          background: rgba(255, 255, 255, 0.12);
        }

        .form-input::placeholder {
          color: rgba(255, 255, 255, 0.6);
        }

        .submit-button {
          width: 100%;
          background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
          color: white;
          border: none;
          border-radius: 12px;
          padding: 14px;
          font-size: 1rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          margin-bottom: 16px;
        }

        .submit-button:hover {
          transform: translateY(-1px);
          background: linear-gradient(135deg, #16A34A 0%, #15803D 100%);
        }

        .early-support-link {
          display: block;
          text-align: center;
          color: rgba(255, 255, 255, 0.7);
          text-decoration: underline;
          font-size: 0.8rem;
          cursor: pointer;
          transition: color 0.3s ease;
        }

        .early-support-link:hover {
          color: white;
        }

        .close-button {
          position: absolute;
          top: 16px;
          right: 16px;
          background: none;
          border: none;
          color: rgba(255, 255, 255, 0.7);
          font-size: 1.5rem;
          cursor: pointer;
          transition: color 0.3s ease;
        }

        .close-button:hover {
          color: white;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .glass-panel {
            position: fixed;
            width: var(--mobile-panel-width);
            max-width: var(--mobile-panel-max-width);
            left: 50%;
            transform: translateX(-50%);
            padding: 18px;
            /* Disable touch interactions that cause sliding */
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
          }
          
          /* Ensure panels stay locked in position on mobile */
          .glass-panel:active {
            transform: translateX(-50%) !important;
          }

          .price-panel {
            bottom: var(--mobile-price-bottom);
            top: auto;
            right: auto;
          }

          .description-panel {
            bottom: var(--mobile-desc-bottom);
            top: auto;
            right: auto;
          }
          
          #three-canvas {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1 !important;
          }

          .glass-panel h1 {
            font-size: 2rem;
          }

          .glass-panel h2 {
            font-size: 1.3rem;
          }

          .glass-panel p {
            font-size: 0.95rem;
          }

          .buy-button {
            padding: 12px 24px;
            font-size: 1rem;
          }

          .modal-content {
            padding: 24px;
          }
        }

        /* Hide scrollbars */
        ::-webkit-scrollbar {
          display: none;
        }
        
        html {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }

        #three-canvas {
          display: block;
          width: 100%;
          height: 100%;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="canvas-container">
            <canvas id="three-canvas"></canvas>
            
            <!-- Price Panel -->
            <div class="glass-panel price-panel">
                <div style="text-align: center;">
                    <h1>$299.99</h1>
                    <button class="buy-button" onclick="handlePurchase()">Buy</button>
                </div>
            </div>

            <!-- Description Panel -->
            <div class="glass-panel description-panel">
                <div>
                    <h2>Helm</h2>
                    <div style="margin-top: 8px;">
                        <p class="text-sm" style="opacity: 0.9;">Cota Pilot Project</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Collection Modal -->
        <div class="modal-overlay" id="email-modal">
            <div class="modal-content">
                <button class="close-button" onclick="closeModal()">&times;</button>
                <h2 class="modal-title">Thank you for your interest!</h2>
                <p class="modal-text">Unfortunately, this item isn't available yet. We'd love to keep in contact.</p>
                
                <form id="email-form" onsubmit="handleEmailSubmit(event)">
                    <div class="form-group">
                        <label class="form-label">📧 Email:</label>
                        <input type="email" class="form-input" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">📷 Instagram:</label>
                        <input type="text" class="form-input" placeholder="@yourusername">
                    </div>
                    
                    <button type="submit" class="submit-button">Submit</button>
                </form>
                
                <a href="https://buy.stripe.com/test_YOUR_PAYMENT_LINK_HERE" 
                   target="_blank" 
                   class="early-support-link">
                    I don't care, I want to buy this early in support.
                </a>
            </div>
        </div>
    </div>

    <!-- Three.js from CDN -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

    <script>
        // 3D Scene Variables
        let scene, camera, renderer, cube;
        let raycaster, mouse;
        
        // Interaction state
        let isRotating = false;
        let isMoving = false;
        let isDragging = false;
        
        // Input tracking
        let lastPointer = { x: 0, y: 0 };
        let tapCount = 0;
        let tapTimer = null;
        
        // Position persistence - responsive positioning
        let cubePosition = window.innerWidth <= 768 ? { x: 0, y: 0.8, z: 0 } : { x: -1.2, y: 0, z: 0 };
        
        // Animation timing
        let time = 0;

        function init() {
            // Scene setup
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
            
            // Renderer setup with soft, holy lighting
            const canvas = document.getElementById('three-canvas');
            renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 0);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            // Holy, soft lighting setup
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0xffffff, 0.3);
            pointLight.position.set(-10, -10, -10);
            scene.add(pointLight);

            // Raycaster for picking
            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            // Create holy cube
            createCube();

            // Camera position
            camera.position.set(0, 0, 5);

            // Event listeners for precise input
            addEventListeners();

            // Start holy animation
            animate();
        }

        function createCube() {
            // Main cube with holy green metallic material
            const geometry = new THREE.BoxGeometry(
                window.innerWidth <= 768 ? 1.0 : 1.5, 
                window.innerWidth <= 768 ? 1.0 : 1.5, 
                window.innerWidth <= 768 ? 1.0 : 1.5
            );
            const material = new THREE.MeshStandardMaterial({
                color: 0x22C55E,
                metalness: 0.9,
                roughness: 0.1,
                emissive: 0x16A34A,
                emissiveIntensity: 0.1
            });
            
            cube = new THREE.Mesh(geometry, material);
            cube.position.set(cubePosition.x, cubePosition.y, cubePosition.z);
            cube.castShadow = true;
            cube.receiveShadow = true;
            scene.add(cube);

            // Add holy labels that stay properly aligned
            addCubeLabels();
        }

        function addCubeLabels() {
            // Create labels as children to maintain proper alignment
            const isMobile = window.innerWidth <= 768;
            const labelDistance = isMobile ? 0.51 : 0.76;
            const labels = [
                { text: 'HELM', position: [0, 0, labelDistance], rotation: [0, 0, 0] },
                { text: 'PREMIUM', position: [labelDistance, 0, 0], rotation: [0, Math.PI/2, 0] },
                { text: 'COTA', position: [0, labelDistance, 0], rotation: [-Math.PI/2, 0, 0] },
                { text: 'DESIGN', position: [-labelDistance, 0, 0], rotation: [0, -Math.PI/2, 0] },
                { text: 'PILOT', position: [0, 0, -labelDistance], rotation: [0, Math.PI, 0] },
                { text: 'PROJECT', position: [0, -labelDistance, 0], rotation: [Math.PI/2, 0, 0] }
            ];

            labels.forEach(label => {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 256;
                canvas.height = 64;

                // Holy white background
                context.fillStyle = 'rgba(255, 255, 255, 0.9)';
                context.fillRect(0, 0, canvas.width, canvas.height);

                // Clean black text
                context.fillStyle = 'black';
                context.font = 'bold 24px Arial';
                context.textAlign = 'center';
                context.textBaseline = 'middle';
                context.fillText(label.text, canvas.width / 2, canvas.height / 2);

                // Create texture and material
                const texture = new THREE.CanvasTexture(canvas);
                const textMaterial = new THREE.MeshBasicMaterial({ 
                    map: texture, 
                    transparent: true 
                });

                // Create plane for text (properly scaled for cube size)
                const planeGeometry = new THREE.PlaneGeometry(
                    isMobile ? 0.6 : 0.9, 
                    isMobile ? 0.15 : 0.225
                );
                const textPlane = new THREE.Mesh(planeGeometry, textMaterial);

                // Position and rotate as child of cube
                textPlane.position.set(...label.position);
                textPlane.rotation.set(...label.rotation);
                
                cube.add(textPlane);
            });
        }

        function addEventListeners() {
            const canvas = renderer.domElement;

            // Mouse events for desktop
            canvas.addEventListener('mousedown', onPointerDown);
            window.addEventListener('mousemove', onPointerMove);
            window.addEventListener('mouseup', onPointerUp);

            // Touch events for mobile
            canvas.addEventListener('touchstart', onPointerDown, { passive: false });
            window.addEventListener('touchmove', onPointerMove, { passive: false });
            window.addEventListener('touchend', onPointerUp, { passive: false });

            // Prevent context menu
            canvas.addEventListener('contextmenu', e => e.preventDefault());

            // Window resize
            window.addEventListener('resize', onWindowResize);
        }

        function onPointerDown(event) {
            event.preventDefault();
            
            const rect = renderer.domElement.getBoundingClientRect();
            const clientX = event.clientX || (event.touches && event.touches[0].clientX);
            const clientY = event.clientY || (event.touches && event.touches[0].clientY);

            // Store current pointer position
            lastPointer.x = clientX;
            lastPointer.y = clientY;

            // Update mouse for raycasting
            mouse.x = ((clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((clientY - rect.top) / rect.height) * 2 + 1;

            // Check if clicking on cube
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(cube);

            if (intersects.length > 0) {
                // Handle tap counting for double-tap detection
                tapCount++;
                
                if (tapTimer) clearTimeout(tapTimer);
                
                if (tapCount === 1) {
                    // Single tap - start rotation mode
                    tapTimer = setTimeout(() => {
                        isRotating = true;
                        isDragging = true;
                        tapCount = 0;
                        console.log('Single tap - rotation mode');
                    }, 200);
                } else if (tapCount === 2) {
                    // Double tap - start movement mode
                    clearTimeout(tapTimer);
                    isMoving = true;
                    isDragging = true;
                    tapCount = 0;
                    console.log('Double tap - movement mode');
                }
            }
        }

        function onPointerMove(event) {
            if (!isDragging) return;

            event.preventDefault();

            const clientX = event.clientX || (event.touches && event.touches[0].clientX);
            const clientY = event.clientY || (event.touches && event.touches[0].clientY);

            // Calculate deltas for 1:1 movement
            const deltaX = (clientX - lastPointer.x) * 0.01;
            const deltaY = (clientY - lastPointer.y) * 0.01;

            if (isRotating) {
                // 1:1 rotation with natural axis preservation
                cube.rotation.y += deltaX;
                cube.rotation.x += deltaY;
            } else if (isMoving) {
                // 1:1 movement anywhere on screen
                cube.position.x += deltaX;
                cube.position.y -= deltaY; // Invert Y for natural movement
            }

            // Update last pointer position
            lastPointer.x = clientX;
            lastPointer.y = clientY;
        }

        function onPointerUp(event) {
            if (isDragging) {
                console.log('Released - returning to holy idle state');
            }
            
            isRotating = false;
            isMoving = false;
            isDragging = false;
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);

            // Update cube size and position for mobile/desktop
            if (cube) {
                const isMobile = window.innerWidth <= 768;
                const newSize = isMobile ? 1.0 : 1.5;
                
                cube.geometry.dispose();
                cube.geometry = new THREE.BoxGeometry(newSize, newSize, newSize);
                
                // Update position
                cubePosition = isMobile ? { x: 0, y: 0.8, z: 0 } : { x: -1.2, y: 0, z: 0 };
                cube.position.set(cubePosition.x, cubePosition.y, cubePosition.z);
                
                // Recreate labels with proper scaling
                cube.children.forEach(child => cube.remove(child));
                addCubeLabels();
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            
            time += 0.01;
            
            // Holy idle behavior: soft Y-axis spin and rhythmic bounce
            if (!isDragging) {
                cube.rotation.y += 0.005; // Constant gentle spin
                cube.position.y = cubePosition.y + Math.sin(time * 0.8) * 0.05; // Rhythmic bounce
            }
            
            renderer.render(scene, camera);
        }

        // Purchase Flow Functions
        function handlePurchase() {
            document.getElementById('email-modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('email-modal').classList.remove('show');
        }

        function handleEmailSubmit(event) {
            event.preventDefault();
            
            const email = event.target.querySelector('input[type="email"]').value;
            const instagram = event.target.querySelector('input[type="text"]').value;
            
            console.log('Email submitted:', { email, instagram });
            
            // Simple success feedback
            alert('Thank you! We\'ll contact you when Helm becomes available.');
            closeModal();
        }

        // Close modal when clicking outside
        document.getElementById('email-modal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeModal();
            }
        });

        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
