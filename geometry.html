<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helm - 3D Interactive Product</title>
    <style>
        /* Custom CSS Variables for Easy Spacing Adjustments */
        :root {
          --desktop-price-top: 20vh;
          --desktop-desc-top: 40vh;
          --desktop-panels-right: 3vw;
          --desktop-panel-width: 280px;
          --mobile-price-bottom: 180px;
          --mobile-desc-bottom: 100px;
          --mobile-panel-width: 90vw;
          --mobile-panel-max-width: 350px;
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
          background: #000000;
          min-height: 100vh;
          overflow: hidden;
        }

        #root {
          width: 100vw;
          height: 100vh;
          position: relative;
        }

        .canvas-container {
          width: 100%;
          height: 100%;
          position: relative;
          background: #000000;
        }

        .glass-panel {
          background: rgba(255, 255, 255, 0.08);
          backdrop-filter: blur(48px);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 24px;
          padding: 20px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          color: white;
        }

        .glass-panel-mobile {
          background: rgba(255, 255, 255, 0.08);
          backdrop-filter: blur(48px);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 24px;
          padding: 16px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          color: white;
        }

        .btn-primary {
          background-color: #22c55e;
          color: white;
          border: none;
          padding: 8px 24px;
          border-radius: 16px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s;
        }

        .btn-primary:hover {
          background-color: #16a34a;
          transform: translateY(-1px);
        }

        /* Desktop Layout */
        @media (min-width: 768px) {
          .desktop-panels { display: block; }
          .mobile-panels { display: none; }
          
          .price-panel-desktop {
            position: absolute;
            z-index: 10;
            top: var(--desktop-price-top);
            right: var(--desktop-panels-right);
            width: var(--desktop-panel-width);
          }
          
          .desc-panel-desktop {
            position: absolute;
            z-index: 10;
            top: var(--desktop-desc-top);
            right: var(--desktop-panels-right);
            width: var(--desktop-panel-width);
          }
        }

        /* Mobile Layout */
        @media (max-width: 767px) {
          .desktop-panels { display: none; }
          .mobile-panels { display: block; }
          
          .price-panel-mobile {
            position: absolute;
            z-index: 10;
            bottom: var(--mobile-price-bottom);
            left: 50%;
            transform: translateX(-50%);
            width: var(--mobile-panel-width);
            max-width: var(--mobile-panel-max-width);
          }
          
          .desc-panel-mobile {
            position: absolute;
            z-index: 10;
            bottom: var(--mobile-desc-bottom);
            left: 50%;
            transform: translateX(-50%);
            width: var(--mobile-panel-width);
            max-width: var(--mobile-panel-max-width);
          }
        }

        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 12px; }

        canvas {
          display: block;
          width: 100% !important;
          height: 100% !important;
          touch-action: none;
          cursor: grab;
        }

        canvas:active {
          cursor: grabbing;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="canvas-container">
            <canvas id="three-canvas"></canvas>
            
            <!-- Desktop Layout -->
            <div class="desktop-panels">
                <div class="price-panel-desktop">
                    <div class="glass-panel">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-lg font-bold">Helm</h2>
                                <p class="text-2xl font-bold">$299.99</p>
                            </div>
                            <button class="btn-primary" onclick="handlePurchase()">Buy</button>
                        </div>
                    </div>
                </div>

                <div class="desc-panel-desktop">
                    <div class="glass-panel">
                        <h3 class="text-base font-semibold mb-3">Product Description:</h3>
                        <p class="text-sm" style="opacity: 0.9;">Cota Pilot Project</p>
                    </div>
                </div>
            </div>

            <!-- Mobile Layout -->
            <div class="mobile-panels">
                <div class="price-panel-mobile">
                    <div class="glass-panel-mobile">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-lg font-bold">Helm</h2>
                                <p class="text-xl font-bold">$299.99</p>
                            </div>
                            <button class="btn-primary" onclick="handlePurchase()">Buy</button>
                        </div>
                    </div>
                </div>

                <div class="desc-panel-mobile">
                    <div class="glass-panel-mobile">
                        <h3 class="text-sm font-semibold mb-2">Product Description:</h3>
                        <p class="text-sm" style="opacity: 0.9;">Cota Pilot Project</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Three.js from CDN -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

    <script>
        // 3D Scene Variables
        let scene, camera, renderer, cube, isDragging = false;
        let mouseX = 0, mouseY = 0, targetRotationY = 0, targetRotationX = 0;
        let rotationVelocityY = 0, rotationVelocityX = 0;
        let lastTap = 0, isSecretMode = false, isHolding = false;
        let floatingTime = 0, clickCount = 0, clickTimer = null;

        function init() {
            // Scene setup
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            
            // Renderer setup
            const canvas = document.getElementById('three-canvas');
            renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 0);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            // Lighting (matching .replit.dev exactly)
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0xffffff, 0.3);
            pointLight.position.set(-10, -10, -10);
            scene.add(pointLight);

            // Create cube
            createCube();

            // Camera position (matching .replit.dev)
            camera.position.set(0, 0, 5);
            camera.fov = 50;

            // Event listeners
            addEventListeners();

            // Start animation
            animate();
        }

        function createCube() {
            // Main cube
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.MeshStandardMaterial({
                color: 0x22C55E,
                metalness: 0.9,
                roughness: 0.1,
                emissive: 0x16A34A,
                emissiveIntensity: 0.1
            });
            
            cube = new THREE.Mesh(geometry, material);
            cube.position.set(-1, 0, 0);
            cube.castShadow = true;
            cube.receiveShadow = true;
            scene.add(cube);

            // Add text labels
            addCubeLabels();
        }

        function addCubeLabels() {
            const labels = [
                { text: 'HELM', position: [0, 0, 0.51], rotation: [0, 0, 0] },
                { text: 'PREMIUM', position: [0.51, 0, 0], rotation: [0, Math.PI/2, 0] },
                { text: 'COTA', position: [0, 0.51, 0], rotation: [-Math.PI/2, 0, 0] },
                { text: 'DESIGN', position: [-0.51, 0, 0], rotation: [0, -Math.PI/2, 0] },
                { text: 'PILOT', position: [0, 0, -0.51], rotation: [0, Math.PI, 0] },
                { text: 'PROJECT', position: [0, -0.51, 0], rotation: [Math.PI/2, 0, 0] }
            ];

            labels.forEach(label => {
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = 256;
                canvas.height = 64;

                // Background
                context.fillStyle = 'rgba(255, 255, 255, 0.9)';
                context.fillRect(0, 0, canvas.width, canvas.height);

                // Text
                context.fillStyle = 'black';
                context.font = 'bold 24px Arial';
                context.textAlign = 'center';
                context.textBaseline = 'middle';
                context.fillText(label.text, canvas.width / 2, canvas.height / 2);

                // Create texture and material
                const texture = new THREE.CanvasTexture(canvas);
                const textMaterial = new THREE.MeshBasicMaterial({ 
                    map: texture, 
                    transparent: true 
                });

                // Create plane for text
                const textGeometry = new THREE.PlaneGeometry(0.8, 0.2);
                const textMesh = new THREE.Mesh(textGeometry, textMaterial);
                
                textMesh.position.set(...label.position);
                textMesh.rotation.set(...label.rotation);
                
                cube.add(textMesh);
            });
        }

        function addEventListeners() {
            const canvas = document.getElementById('three-canvas');
            
            // Mouse events
            canvas.addEventListener('mousedown', onMouseDown);
            canvas.addEventListener('mousemove', onMouseMove);
            canvas.addEventListener('mouseup', onMouseUp);
            
            // Touch events
            canvas.addEventListener('touchstart', onTouchStart, { passive: false });
            canvas.addEventListener('touchmove', onTouchMove, { passive: false });
            canvas.addEventListener('touchend', onTouchEnd, { passive: false });
            
            // Window resize
            window.addEventListener('resize', onWindowResize);
            canvas.addEventListener('contextmenu', e => e.preventDefault());
        }

        function onMouseDown(event) {
            clickCount++;
            
            if (clickCount === 1) {
                // First click - start rotation mode
                isDragging = true;
                isSecretMode = false;
                mouseX = event.clientX;
                mouseY = event.clientY;
                
                clickTimer = setTimeout(() => {
                    clickCount = 0;
                }, 500);
                
            } else if (clickCount === 2) {
                // Second click - enter drag mode if held
                clearTimeout(clickTimer);
                isHolding = true;
                isSecretMode = true;
                isDragging = true;
                
                console.log('🎉 Drag mode activated! Hold to move cube freely!');
                cube.material.emissiveIntensity = 0.3;
                
                mouseX = event.clientX;
                mouseY = event.clientY;
                clickCount = 0;
            }
        }

        function onMouseMove(event) {
            if (!isDragging) return;

            const deltaX = event.clientX - mouseX;
            const deltaY = event.clientY - mouseY;

            if (!isSecretMode) {
                const rotationSpeedY = deltaX * 0.01;
                const rotationSpeedX = deltaY * 0.01;
                
                // Apply rotation directly to the cube
                cube.rotation.y += rotationSpeedY;
                cube.rotation.x += rotationSpeedX;
                
                // Clamp X rotation to prevent flipping
                cube.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, cube.rotation.x));
                
                // Set momentum for after drag ends
                rotationVelocityY = rotationSpeedY * 0.3;
                rotationVelocityX = rotationSpeedX * 0.3;
            } else {
                // Secret mode: move cube freely
                const sensitivity = 5;
                cube.position.x += (deltaX / window.innerWidth) * sensitivity;
                cube.position.y -= (deltaY / window.innerHeight) * sensitivity;
            }

            mouseX = event.clientX;
            mouseY = event.clientY;
        }

        function onMouseUp() {
            if (isHolding && isSecretMode) {
                // Release from drag mode
                isSecretMode = false;
                isHolding = false;
                cube.material.emissiveIntensity = 0.1;
                console.log('✨ Back to rotation mode');
            }
            
            isDragging = false;
        }

        function onTouchStart(event) {
            event.preventDefault();
            
            clickCount++;
            
            if (clickCount === 1) {
                // First click - start rotation mode
                isDragging = true;
                isSecretMode = false;
                mouseX = event.touches[0].clientX;
                mouseY = event.touches[0].clientY;
                
                clickTimer = setTimeout(() => {
                    clickCount = 0;
                }, 500);
                
            } else if (clickCount === 2) {
                // Second click - enter drag mode if held
                clearTimeout(clickTimer);
                isHolding = true;
                isSecretMode = true;
                isDragging = true;
                
                console.log('🎉 Drag mode activated! Hold to move cube freely!');
                cube.material.emissiveIntensity = 0.3;
                
                mouseX = event.touches[0].clientX;
                mouseY = event.touches[0].clientY;
                clickCount = 0;
            }
        }

        function onTouchMove(event) {
            event.preventDefault();
            if (!isDragging || event.touches.length !== 1) return;

            const deltaX = event.touches[0].clientX - mouseX;
            const deltaY = event.touches[0].clientY - mouseY;

            if (!isSecretMode) {
                const rotationSpeedY = deltaX * 0.01;
                const rotationSpeedX = deltaY * 0.01;
                
                // Apply rotation directly to the cube
                cube.rotation.y += rotationSpeedY;
                cube.rotation.x += rotationSpeedX;
                
                // Clamp X rotation
                cube.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, cube.rotation.x));
                
                // Set momentum for after drag ends
                rotationVelocityY = rotationSpeedY * 0.3;
                rotationVelocityX = rotationSpeedX * 0.3;
            } else {
                // Secret mode: move cube freely
                const sensitivity = 5;
                cube.position.x += (deltaX / window.innerWidth) * sensitivity;
                cube.position.y -= (deltaY / window.innerHeight) * sensitivity;
            }

            mouseX = event.touches[0].clientX;
            mouseY = event.touches[0].clientY;
        }

        function onTouchEnd(event) {
            event.preventDefault();
            
            if (isHolding && isSecretMode) {
                // Release from drag mode
                isSecretMode = false;
                isHolding = false;
                cube.material.emissiveIntensity = 0.1;
                console.log('✨ Back to rotation mode');
            }
            
            isDragging = false;
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            floatingTime += 0.016; // ~60fps

            if (!isDragging && !isSecretMode) {
                // Apply momentum and drift
                cube.rotation.y += rotationVelocityY;
                cube.rotation.x += rotationVelocityX;
                
                // Damping
                rotationVelocityY *= 0.95;
                rotationVelocityX *= 0.95;
                
                // Natural drift
                cube.rotation.y += 0.005;
                
                // Very subtle floating animation (matching .replit.dev)
                const baseY = -0.0;
                cube.position.y = baseY + Math.sin(floatingTime * 0.8) * 0.002;
                
                // Clamp X rotation
                cube.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, cube.rotation.x));
            }

            renderer.render(scene, camera);
        }

        function handlePurchase() {
            alert('Purchase functionality would be integrated here!\n\nFeatures:\n• Interactive 3D Product\n• Drag to rotate\n• Double-tap for secret mode\n• Mobile optimized');
        }

        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>